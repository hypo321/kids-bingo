<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="https://olioapp.com/en/wp-content/uploads/sites/1/2023/03/cropped-icon-512-1-32x32.png"
    sizes="32x32" />
  <link rel="icon" href="https://olioapp.com/en/wp-content/uploads/sites/1/2023/03/cropped-icon-512-1-192x192.png"
    sizes="192x192" />
  <link rel="apple-touch-icon"
    href="https://olioapp.com/en/wp-content/uploads/sites/1/2023/03/cropped-icon-512-1-180x180.png" />
  <meta name="msapplication-TileImage"
    content="https://olioapp.com/en/wp-content/uploads/sites/1/2023/03/cropped-icon-512-1-270x270.png" />
  <title>Spring Clean Bingo</title>
  <style>
    /* Reset and base styles */
    * {
      box-sizing: border-box;
    }

    @font-face {
      font-family: 'Cosmica Bold';
      src: url('Cosmica-Bold.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }

    @font-face {
      font-family: 'Plus Jakarta Sans';
      src: url('PlusJakartaSans-VariableFont_wght.woff2') format('woff2');
      font-weight: 100 900;
      font-style: normal;
    }

    html,
    body {
      height: 100%;
      font-family: 'Plus Jakarta Sans', sans-serif;
      padding: 0;
      margin: 0;
    }

    h1,
    h2,
    .bold-text {
      font-family: 'Cosmica Bold', sans-serif;
    }

    html {
      background: url('spring-clean-background.png') center;
      background-size: auto;
    }

    body {
      --w: calc(2vw);
      --h: calc(2vh);
      font-size: clamp(0.6rem, min(var(--w), var(--h)), 2rem);
    }

    img {
      pointer-events: none
    }

    /* Title banner styling */
    .title {
      grid-area: header;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;

      gap: 0.5rem;
      font-size: 4rem;
    }

    @media (orientation: portrait) {
      .title {
        font-size: 3rem;
        flex-direction: column;
        line-height: 3rem;
      }
    }

    .title span.purpleText {
      color: #261750;
    }

    .title span.pinkText {
      color: #ff4c70;
    }

    .title img {
      width: 100%;
      max-width: 400px;

      margin: 0;
      padding: 0;
    }

    /* Board container styling */
    #boardContainer {
      grid-area: board;
      position: relative;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: repeat(4, 1fr);
      gap: 4px;
      width: 80vmin;
      height: 80vmin;
      margin: 0 auto;
      --w: calc(calc(100vw / 5) + calc(4 * 4));
      --h: calc(calc(100vh / 5) + calc(4 * 4));
      width: min(var(--w), var(--h));
      height: min(var(--w), var(--h));
    }

    /* Cell styling */
    .cell {
      background: #dedbec;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      font-weight: bold;
      color: #fff;
      text-align: center;
      padding: 1%;
      --w: calc(100vw / 5.5);
      --h: calc(100vh / 5.5);
      width: min(var(--w), var(--h));
      height: min(var(--w), var(--h));
      cursor: pointer;
      user-select: none;
      border-radius: 15%;
    }

    .pink {
      background: #ff4c70;
      transition: background-color 0.5s ease-in-out;
      border: #ffb000 2px solid;
    }

    .orange {
      background: #ffb000;
      transition: background-color 0.5s ease-in-out;
      border: #ff4c70 2px solid;
    }

    .checked {
      background: #00bf63;
      transition: background-color 1.5s ease-in-out;
    }

    /* Footer and logo styling */
    #logo {
      width: clamp(100px, calc(5vw + 10vh), 200px);
      height: auto;
      pointer-events: none;
      margin: auto;
    }

    #footer {
      grid-area: footer;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
      margin: auto;
    }

    /* Main grid layout */
    .mainColumn {
      display: grid;
      grid-template-areas:
        "header"
        "board"
        "footer";
      grid-template-rows: 10% 1fr auto;

      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100vh;
    }

    @media (orientation: portrait) {
      .mainColumn {
        grid-template-rows: 20% auto auto;
      }
    }

    @media (max-height: 850px) and (min-width: 650px) {
      .mainColumn {
        grid-template-columns: 60% 1fr;
        width: auto;
        grid-template-rows: 1fr 1fr 1fr;
        grid-template-areas:
          "board header"
          "board buttons"
          "board footer";
        gap: 2rem;
      }
    }

    /* Canvas for confetti */
    #confettiCanvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
    }

    /* Modal styling */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 10000;
    }

    .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      width: 80%;
      max-width: 700px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      text-wrap: balanced;
    }

    .modal-content h2 {
      margin-top: 0;
    }

    .modal-content button {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 1rem;
      cursor: pointer;
      border: none;
      background: #ff4c70;
      color: #fff;
      border-radius: 4px;
    }

    /* Help icon styling */
    #help-icon {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #ff4c70;
      color: #fff;
      font-size: 2rem;
      line-height: normal;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      z-index: 999;
    }

    @media screen and (min-width: 800px) and (max-height: 600px) {
      body {
        font-size: 0.8rem;
      }
    }

    #footerContainer button {
      margin: 0 15px;
      padding: 10px 20px;
      font-size: 1rem;
      cursor: pointer;
      border: none;
      background: #ff4c70;
      color: #fff;
      border-radius: 4px;
    }

/* Default (1 column) layout: buttons on either side of the logo */
#footerContainer {
  display: flex;
  align-items: center;
  justify-content: center;
  grid-area: footer;
  gap: 20px;
  padding: 20px;
}




  </style>
</head>

<body>
  <canvas id="confettiCanvas"></canvas>
  <div id="help-icon">?</div>
  <div class="mainColumn">
    <div class="title">
      <img src="logo-bingo.png" alt="Spring Clean Bingo" />
    </div>
    <div id="boardContainer">
      <div id="cell0" class="cell pink">Declutter your pantry or cupboards</div>
      <div id="cell1" class="cell orange">List a pantry item on Olio</div>
      <div id="cell2" class="cell pink">Answer a neighbour‚Äôs Wanted post on the app</div>
      <div id="cell3" class="cell orange">Share spare kitchen items</div>
      <div id="cell4" class="cell orange">List an item for sale on Olio</div>
      <div id="cell5" class="cell pink">Have a fridge clearout</div>
      <div id="cell6" class="cell orange">"Share a 'before and after' photo of your clear out"</div>
      <div id="cell7" class="cell pink">List a piece of clothing on Olio</div>
      <div id="cell8" class="cell pink">List a book on Olio</div>
      <div id="cell9" class="cell orange">Declutter under your bed</div>
      <div id="cell10" class="cell pink">Organise your wardrobe</div>
      <div id="cell11" class="cell orange">Sort out your cleaning supplies</div>
      <div id="cell12" class="cell orange">Tackle 'THAT' drawer</div>
      <div id="cell13" class="cell pink">Unlock the 'Spring Cleaner' badge</div>
      <div id="cell14" class="cell orange">List unused and unwanted toiletries</div>
      <div id="cell15" class="cell pink">Organise your storage boxes</div>
    </div>
    <!-- New footer container for buttons and logo -->
    <div id="footerContainer">
      <button id="resetButton">Reset</button>
      <img src="olio_purple.png" id="logo" alt="Olio Logo" />
      <button id="shareButton">Share</button>
    </div>

    <!-- Reset confirmation modal -->
    <div id="resetModal" class="modal">
      <div class="modal-content">
        <h2>Confirm Reset</h2>
        <p>Are you sure you want to reset the board?</p>
        <button id="confirmReset">Yes, Reset</button>
        <button id="cancelReset">Cancel</button>
      </div>
    </div>

    <!-- Share preview modal -->
    <div id="shareModal" class="modal">
      <div class="modal-content">
        <h2>Share Your Progress</h2>
        <p id="shareText"></p>
        <button id="confirmShare">Share</button>
        <button id="cancelShare">Cancel</button>
      </div>
    </div>
  </div>
  <div id="modal" class="modal">
    <div class="modal-content">
      <h2>üåü Instructions üåü</h2>
      <p>
        This Bingo card is a fun and interactive way for you to help out at home during spring cleaning time. Each
        square has a simple task you can do to lend a hand and make spring cleaning a family effort.
      </p>
      <p><strong>‚úÖ How to play:</strong></p>
      <ul style="list-style: none; padding: 0;">
        <li>‚Ä¢ Tap or click a square when you‚Äôve finished the task to tick it off</li>
        <li>‚Ä¢ Try to complete as many as you can ‚Äì one tick at a time!</li>
        <li>‚Ä¢ Made a mistake? Press on the square again to undo it</li>
      </ul>
      <p>
        So roll up your sleeves, grab a grown-up if you need help, and let‚Äôs get spring cleaning! üí™üèºüßΩ
      </p>
      <p>Good luck and have fun! üåº</p>
      <button id="modal-ok">OK</button>
    </div>
  </div>
  <script>
    // Adjust canvas size for confetti
    const canvas = document.getElementById('confettiCanvas');
    const ctx = canvas.getContext('2d');
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // Confetti animation functions
    const confettiCount = 150;
    let confetti = [];
    const colours = ['#FFC107', '#E91E63', '#9C27B0', '#03A9F4', '#4CAF50'];
    function initConfetti() {
      confetti = [];
      for (let i = 0; i < confettiCount; i++) {
        confetti.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height - canvas.height,
          r: Math.random() * 6 + 2,
          d: Math.random() * confettiCount,
          colour: colours[Math.floor(Math.random() * colours.length)],
          tilt: Math.floor(Math.random() * 10) - 10,
          tiltAngleIncremental: Math.random() * 0.07 + 0.05,
          tiltAngle: 0
        });
      }
    }
    function drawConfetti() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let i = 0; i < confettiCount; i++) {
        const p = confetti[i];
        ctx.beginPath();
        ctx.lineWidth = p.r;
        ctx.strokeStyle = p.colour;
        ctx.moveTo(p.x + p.tilt + p.r / 2, p.y);
        ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r / 2);
        ctx.stroke();
      }
      updateConfetti();
    }
    let angle = 0;
    function updateConfetti() {
      angle += 0.01;
      for (let i = 0; i < confettiCount; i++) {
        const p = confetti[i];
        p.tiltAngle += p.tiltAngleIncremental;
        p.y += (Math.cos(angle + p.d) + 3 + p.r / 2) / 2;
        p.x += Math.sin(angle);
        p.tilt = Math.sin(p.tiltAngle) * 15;
        if (p.y > canvas.height) {
          p.y = -10;
          p.x = Math.random() * canvas.width;
        }
      }
    }
    let animationFrameId = null;
    function animateConfetti() {
      drawConfetti();
      animationFrameId = requestAnimationFrame(animateConfetti);
    }
    function startConfetti() {
      if (!animationFrameId) {
        initConfetti();
        animateConfetti();
      }
    }
    function stopConfetti() {
      if (animationFrameId) {
        cancelAnimationFrame(animationFrameId);
        animationFrameId = null;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      }
    }
    initConfetti();

    // Retrieve saved cell state and set up the board
    let savedState = localStorage.getItem('springBingoState');
    let cellChecked = savedState ? JSON.parse(savedState) : Array(16).fill(false);
    const cells = Array.from({ length: 16 }, (_, i) => document.getElementById('cell' + i));
    const centerCell = document.getElementById('cell4');
    function updateCenterCompletion() {
      const allChecked = cellChecked.every((checked) => checked);
      if (allChecked) {
        centerCell.classList.add('complete');
        startConfetti();
      } else {
        centerCell.classList.remove('complete');
        stopConfetti();
      }
    }

   // Function to trigger the Sponge animation at a given (x, y) position.
    function triggerSpongeAnimation(x, y, onComplete) {
      // Create a container div for the animation
      const sponge = document.createElement('div');
      sponge.style.pointerEvents = 'none';
      sponge.style.position = 'absolute';
      sponge.style.left = `${x}px`;
      sponge.style.top = `${y}px`;
      sponge.style.zIndex = '10';
      // Ensure the element is positioned relative to its top-left corner
      sponge.style.transform = 'translate(-50%, -50%)';

      // Create the image element
      const img = document.createElement('img');
      img.src = 'Sponge.png';
      img.alt = 'Sponge';

      // variable to hold the shortest viewport length
      const viewportLength = Math.min(window.innerWidth, window.innerHeight);
      const spongeWidth=  viewportLength * 0.4; // 20% of the shortest viewport length

      // Use a large width (as in your React component)


      img.style.width = `${spongeWidth}px`;
      img.style.maxWidth = 'none';
      img.style.maxHeight = 'none';
      // Adjust the internal image offset if needed
      img.style.transform = 'translate(-30%, -50%)';
      sponge.appendChild(img);
      document.body.appendChild(sponge); // Append to body or another container as needed

      // Build the keyframe arrays (similar to your React component)
      const circlePoints = 8;
      let xPoints = [150, 0];
      let yPoints = [150, 0];
      let opacityPoints = [0, 1];
      let rotationPoints = [-30, -20];

      // Create the 3 circles of motion
      for (let circle = 0; circle < 2; circle++) {
        for (let i = 0; i < circlePoints; i++) {
          const angle = (i / circlePoints) * 2 * Math.PI;
          const radius = 30;
          xPoints.push(Math.cos(angle) * radius);
          yPoints.push(Math.sin(angle) * radius);
          opacityPoints.push(1);
          rotationPoints.push(i % 2 === 0 ? -25 : -15);
        }
      }

      // Add the return points
      xPoints.push(0, 150);
      yPoints.push(0, 150);
      opacityPoints.push(1, 0);
      rotationPoints.push(-20, -30);

      // Generate the timing values for each keyframe (a value between 0 and 1)
      const times = [];
      times.push(0, 0.15);
      const circleMotionDuration = 0.8;
      const circleStartTime = 0.15;
      const circleSegments = circlePoints * 2;
      for (let i = 0; i < circleSegments; i++) {
        times.push(circleStartTime + (i / circleSegments) * circleMotionDuration);
      }
      times.push(0.95, 1.0);

      // Construct keyframes array from the above arrays.
      const keyframes = [];
      for (let i = 0; i < xPoints.length; i++) {
        keyframes.push({
          offset: times[i],
          transform: `translate(${xPoints[i]}px, ${yPoints[i]}px) rotate(${rotationPoints[i]}deg)`,
          opacity: opacityPoints[i]
        });
      }

      // Start the animation: duration is 3000ms with a linear easing.
      const animation = sponge.animate(keyframes, {
        duration: 2000,
        easing: 'linear'
      });

      // Once the animation is finished, remove the element and call the callback.
      animation.onfinish = () => {
        console.log('Sponge animation complete');
        sponge.remove();
        if (onComplete) onComplete();
      };
    }

    // Spray animation using the Web Animations API and setTimeouts
    function triggerSprayAnimation(x, y, onComplete) {
      const sprayContainer = document.createElement('div');
      sprayContainer.style.pointerEvents = 'none';
      sprayContainer.style.position = 'absolute';
      sprayContainer.style.left = `${x}px`;
      sprayContainer.style.top = `${y}px`;
      sprayContainer.style.zIndex = '10';
      // Create the spray image element
      const viewportLength = Math.min(window.innerWidth, window.innerHeight);
      const sprayWidth = viewportLength * 0.6; // 20% of the shortest viewport length

      const sprayImage = document.createElement('img');
      function getSprayImage(phase) {
        switch (phase) {
          case 1:
            return 'spray01.png';
          case 2:
            return 'spray02.png';
          case 3:
            return 'spray03.png';
          default:
            return 'spray01.png';
        }
      }
      let currentPhase = 1;
      sprayImage.src = getSprayImage(currentPhase);
      sprayImage.alt = 'Spray';
      sprayImage.style.width = `${sprayWidth}px`;
      const leftDistance= 0.2 * sprayWidth; // 60% of the spray width
      const topDistance =0; // 50% of the spray width

      //sprayImage.style.marginLeft = '-' + sprayWidth + 'px';
      //sprayImage.style.marginTop = '-' + topDistance + 'px';

      sprayImage.style.marginLeft = '-80%';
      sprayImage.style.marginTop = '-15%';
      sprayContainer.appendChild(sprayImage);
      // Set initial (hidden) style: { x: -750, y: 150, opacity: 0 }
      sprayContainer.style.transform = 'translate(-750px, 150px)';
      sprayContainer.style.opacity = '0';
      document.body.appendChild(sprayContainer);
      // Animate entrance to visible: { x: -350, y: -50, opacity: 1 }
      sprayContainer.animate(
        [
          { transform: 'translate(-750px, 150px)', opacity: 0 },
          { transform: 'translate(0px, 0px)', opacity: 1 }
        ],
        {
          duration: 200,
          easing: 'ease-out',
          fill: 'forwards'
        }
      );
      // Define the spray sequence timings
      const ANIMATION_SEQUENCE = [
        { phase: 1, duration: 200 },
        { phase: 2, duration: 500 },
        { phase: 3, duration: 200 },
        { phase: 2, duration: 200 },
        { phase: 1, duration: 200 },
        { phase: 2, duration: 500 },
        { phase: 3, duration: 200 },
        { phase: 2, duration: 200 },
        { phase: 1, duration: 200 }
      ];
      let cumulativeDelay = 0;
      ANIMATION_SEQUENCE.forEach(({ phase, duration }) => {
        setTimeout(() => {
          currentPhase = phase;
          sprayImage.src = getSprayImage(currentPhase);
        }, cumulativeDelay);
        cumulativeDelay += duration;
      });
      // After the sequence, animate exit back to hidden state.
      setTimeout(() => {
        const exitAnimation = sprayContainer.animate(
          [
            { transform: 'translate(0px, 0px)', opacity: 1 },
            { transform: 'translate(-750px, 150px)', opacity: 0 }
          ],
          {
            duration: 250,
            easing: 'ease-out',
            fill: 'forwards'
          }
        );
        exitAnimation.onfinish = () => {
          console.log('Spray animation complete');
          sprayContainer.remove();
          if (onComplete) onComplete();
        };
      }, cumulativeDelay);
    }

    // Add click event listeners to cells and integrate both animations.
    cells.forEach((cell, index) => {
      cell.addEventListener('click', () => {
        const currentlyChecked = cellChecked[index];
        cellChecked[index] = !currentlyChecked;
        if (cellChecked[index]) {

          const rect = cell.getBoundingClientRect();
          const centerX = rect.left + rect.width / 2;
          const centerY = rect.top + rect.height / 2;
          // Trigger the spray animation first, then the sponge animation on its completion.
          triggerSprayAnimation(centerX, centerY, () => {
                      cell.classList.add('checked');
            triggerSpongeAnimation(centerX, centerY, () => {
              // Optional: additional code after sponge animation completes.
            });
          });
        } else {
          cell.classList.remove('checked');
        }
        localStorage.setItem('springBingoState', JSON.stringify(cellChecked));
        updateCenterCompletion();
      });
    });
    cells.forEach((cell, index) => {
      if (cellChecked[index]) {
        cell.classList.add('checked');
      }
    });
    updateCenterCompletion();

    // Modal functionality
    const modal = document.getElementById('modal');
    const modalOk = document.getElementById('modal-ok');
    const helpIcon = document.getElementById('help-icon');
    if (!localStorage.getItem('instructionsShown')) {
      modal.style.display = 'flex';
    }
    function hideModal() {
      modal.style.display = 'none';
      localStorage.setItem('instructionsShown', 'true');
    }
    modalOk.addEventListener('click', hideModal);
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        hideModal();
      }
    });
    helpIcon.addEventListener('click', () => {
      modal.style.display = 'flex';
    });

  // Get new elements
  const resetButton = document.getElementById('resetButton');
  const shareButton = document.getElementById('shareButton');
  const resetModal = document.getElementById('resetModal');
  const shareModal = document.getElementById('shareModal');
  const confirmReset = document.getElementById('confirmReset');
  const cancelReset = document.getElementById('cancelReset');
  const confirmShare = document.getElementById('confirmShare');
  const cancelShare = document.getElementById('cancelShare');
  const shareTextEl = document.getElementById('shareText');

  // Show reset modal when button is clicked
  resetButton.addEventListener('click', () => {
    resetModal.style.display = 'flex';
  });
  cancelReset.addEventListener('click', () => {
    resetModal.style.display = 'none';
  });
  confirmReset.addEventListener('click', () => {
    // Reset the board: clear cell states and update storage
    cellChecked = Array(16).fill(false);
    cells.forEach(cell => cell.classList.remove('checked'));
    localStorage.setItem('springBingoState', JSON.stringify(cellChecked));
    updateCenterCompletion();
    resetModal.style.display = 'none';
  });

  // Show share modal when button is clicked
  shareButton.addEventListener('click', () => {
    const completed = cellChecked.filter(Boolean).length;
    const link = window.location.href; // link to the card
    let message = '';
    if (completed === 0) {
      message = `Olio‚Äôs Big Spring Clean Bingo card is such a fun way to stay motivated while decluttering! üí™üéâ\nWhy not join in? Let‚Äôs spring clean together: ${link}`;
    } else if (completed < 16) {
      message = `I completed ${completed} out of 16 tasks on Olio‚Äôs Big Spring Clean Bingo card, and it‚Äôs such a fun way to stay motivated while decluttering! üí™üéâ\nWhy not join in? Let‚Äôs spring clean together: ${link}`;
    } else {
      message = `I‚Äôve officially completed all the tasks on Olio‚Äôs Big Spring Clean Bingo card! ‚úÖ\nFeels so good to declutter, share, and make a difference üíõ\nHaven‚Äôt joined in yet? It‚Äôs not too late ‚Äì grab your card and get cleaning: ${link}`;
    }
    shareTextEl.textContent = message;
    shareModal.style.display = 'flex';
  });
  cancelShare.addEventListener('click', () => {
    shareModal.style.display = 'none';
  });
  confirmShare.addEventListener('click', () => {
    const shareData = {
      title: "Spring Clean Bingo",
      text: shareTextEl.textContent,
      url: window.location.href,
    };
    if (navigator.share) {
      navigator.share(shareData)
        .then(() => console.log('Shared successfully'))
        .catch(err => console.error('Error sharing:', err));
    } else {
      // Fallback: copy the share text to the clipboard
      navigator.clipboard.writeText(shareTextEl.textContent)
        .then(() => alert('Share text copied to clipboard!'))
        .catch(err => console.error('Failed to copy:', err));
    }
    shareModal.style.display = 'none';
  });

  // Optional: hide modals when clicking outside the modal content
  window.addEventListener('click', (e) => {
    if (e.target === resetModal) resetModal.style.display = 'none';
    if (e.target === shareModal) shareModal.style.display = 'none';
  });

  </script>
</body>

</html>